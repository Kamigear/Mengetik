<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tantangan Mengetik Indonesia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #0f172a;
            color: #f8fafc;
            touch-action: manipulation;
            overflow: hidden;
        }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .char { display: inline; border-bottom: 2px solid transparent; transition: all 0.1s; }
        .char.current {
            background-color: #334155;
            border-bottom: 2px solid #38bdf8;
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { border-bottom-color: transparent; } }
        .char.correct { color: #4ade80; }
        .char.incorrect { color: #f87171; background-color: rgba(248, 113, 113, 0.2); }
        
        /* Virtual Keyboard Styles */
        .key {
            user-select: none;
            transition: all 0.05s;
            touch-action: pointer;
        }
        .key:active {
            transform: scale(0.92);
            background-color: #38bdf8 !important;
            color: white !important;
        }
        .key-active {
            background-color: #38bdf8 !important;
            color: white !important;
            transform: scale(0.92);
        }

        /* Sembunyikan keyboard di layar lebar (komputer) */
        @media (min-width: 1024px) {
            #keyboard-container {
                display: none;
            }
            #typing-input {
                display: block !important;
            }
        }
    </style>
</head>
<body class="h-screen flex flex-col p-4 max-h-screen overflow-hidden">

    <div class="flex-1 flex flex-col max-w-4xl w-full mx-auto">
        <!-- Stats Section -->
        <div class="flex justify-between items-center mb-4 bg-slate-800/50 p-3 rounded-2xl border border-slate-700">
            <div class="text-center flex-1">
                <p class="text-[10px] uppercase tracking-widest text-slate-400">WPM</p>
                <p id="wpm" class="text-xl font-bold text-sky-400">0</p>
            </div>
            <div class="text-center flex-1 border-x border-slate-700">
                <p class="text-[10px] uppercase tracking-widest text-slate-400">Akurasi</p>
                <p id="accuracy" class="text-xl font-bold text-emerald-400">0%</p>
            </div>
            <div class="text-center flex-1">
                <p class="text-[10px] uppercase tracking-widest text-slate-400">Waktu</p>
                <p id="timer" class="text-xl font-bold text-amber-400">60s</p>
            </div>
        </div>

        <!-- Display Area -->
        <div class="relative flex-1 bg-slate-800 rounded-2xl p-6 border border-slate-700 mb-4 overflow-y-auto">
            <div id="text-display" class="mono text-xl md:text-2xl leading-relaxed text-slate-400 select-none break-words text-left">
                Klik tombol mulai untuk menguji kecepatan jari Anda.
            </div>
            
            <!-- Hidden input for Desktop users -->
            <input type="text" id="typing-input" class="hidden absolute opacity-0 pointer-events-none" autocomplete="off">

            <div id="start-overlay" class="absolute inset-0 bg-slate-800/95 rounded-2xl flex flex-col items-center justify-center z-10 text-center p-4">
                <h1 class="text-2xl font-black text-sky-400 mb-2">KetikCepat</h1>
                <p class="text-slate-400 text-sm mb-6 italic" id="instruction-text">Gunakan keyboard untuk mengetik.</p>
                <button onclick="startGame()" class="bg-sky-500 hover:bg-sky-400 text-white px-8 py-3 rounded-xl font-bold text-lg transition-all shadow-lg shadow-sky-500/20">
                    Mulai Main
                </button>
                <p class="mt-4 text-xs text-slate-500">Skor Tertinggi: <span id="highscore" class="font-bold">0</span> WPM</p>
            </div>
        </div>

        <!-- Virtual Keyboard Section (Only for Mobile) -->
        <div id="keyboard-container" class="bg-slate-900/50 p-2 rounded-2xl border border-slate-800 select-none mb-2">
            <!-- Row 1 -->
            <div class="flex justify-center gap-1 mb-1">
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="q">Q</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="w">W</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="e">E</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="r">R</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="t">T</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="y">Y</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="u">U</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="i">I</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="o">O</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="p">P</button>
            </div>
            <!-- Row 2 -->
            <div class="flex justify-center gap-1 mb-1 px-4">
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="a">A</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="s">S</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="d">D</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="f">F</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="g">G</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="h">H</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="j">J</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="k">K</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="l">L</button>
            </div>
            <!-- Row 3 -->
            <div class="flex justify-center gap-1">
                <div class="flex-[0.5]"></div>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="z">Z</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="x">X</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="c">C</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="v">V</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="b">B</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="n">N</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm" data-key="m">M</button>
                <button class="key flex-1 h-12 bg-slate-800 rounded-lg font-bold text-sm flex items-center justify-center" data-key="backspace">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>
                </button>
            </div>
            <!-- Row 4 -->
            <div class="flex justify-center mt-1">
                <button class="key w-full h-12 bg-slate-700 rounded-lg font-bold text-sm tracking-widest" data-key=" ">S P A C E</button>
            </div>
        </div>
    </div>

    <!-- Modal Hasil -->
    <div id="result-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md hidden items-center justify-center z-50 p-6">
        <div class="bg-slate-800 border border-slate-700 p-8 rounded-3xl max-w-sm w-full text-center">
            <h2 class="text-2xl font-bold mb-1">Hasil Anda</h2>
            <div id="new-record-tag" class="hidden inline-block bg-amber-500 text-black text-[10px] font-black px-2 py-0.5 rounded mb-4 italic">REKOR BARU!</div>
            
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="bg-slate-900/50 p-3 rounded-xl">
                    <p class="text-xs text-slate-400">Kecepatan</p>
                    <p class="text-2xl font-bold text-sky-400"><span id="final-wpm">0</span></p>
                    <p class="text-[10px] text-slate-500 uppercase">WPM</p>
                </div>
                <div class="bg-slate-900/50 p-3 rounded-xl">
                    <p class="text-xs text-slate-400">Akurasi</p>
                    <p class="text-2xl font-bold text-emerald-400"><span id="final-accuracy">0</span>%</p>
                </div>
            </div>

            <button onclick="resetGame()" class="w-full bg-sky-500 text-white py-3 rounded-xl font-bold shadow-lg shadow-sky-500/20 active:scale-95 transition-all">
                Coba Lagi
            </button>
        </div>
    </div>

    <script>
        const kataIndonesia = [
  "aku", "kamu", "dia", "mereka", "kita", "makan", "minum", "jalan", "lari", "tidur",
  "belajar", "coding", "kerja", "sekolah", "rumah", "buku", "pintu", "jendela", "langit",
  "bumi", "air", "api", "angin", "panas", "dingin", "sehat", "sakit", "senang", "sedih",
  "cepat", "lambat", "tinggi", "rendah", "besar", "kecil", "baru", "lama", "tua", "muda",

  "ayah", "ibu", "adik", "kakak", "teman", "sahabat", "guru", "murid", "dokter", "pasien",
  "kantor", "kampus", "kelas", "meja", "kursi", "tas", "sepatu", "baju", "celana", "topi",
  "motor", "mobil", "kereta", "pesawat", "kapal", "jalan", "gang", "desa", "kota", "negara",
  "pantai", "gunung", "hutan", "sungai", "laut", "danau", "sawah", "kebun", "pasar", "toko",
  "apel", "jeruk", "mangga", "pisang", "anggur", "nasi", "roti", "mie", "ikan", "ayam",
  "daging", "sayur", "gula", "garam", "kopi", "teh", "susu", "coklat", "kue", "permen",
  "hitam", "putih", "merah", "biru", "hijau", "kuning", "ungu", "cokelat", "abu", "emas",
  "bangun", "mandi", "sarapan", "berangkat", "pulang", "istirahat", "bermain", "menulis",
  "membaca", "menggambar", "menonton", "mendengar", "berbicara", "tertawa", "menangis",
  "berlari", "berenang", "melompat", "duduk", "berdiri", "masuk", "keluar", "naik", "turun",
  "buka", "tutup", "ambil", "taruh", "beri", "terima", "cari", "temu", "buat", "pakai",
  "lepas", "pilih", "jawab", "tanya", "ingat", "lupa", "cinta", "benci", "harap", "doa",
  "pagi", "siang", "sore", "malam", "hari", "minggu", "bulan", "tahun", "sekarang",
  "nanti", "kemarin", "besok", "tadi", "awal", "akhir", "tengah", "depan", "belakang",
  "kanan", "kiri", "atas", "bawah", "dalam", "luar", "dekat", "jauh", "ramai", "sepi",
  "mahal", "murah", "mudah", "sulit", "kuat", "lemah", "cerah", "gelap", "bersih", "kotor",
  "basah", "kering", "tajam", "tumpul", "halus", "kasar", "tebal", "tipis", "lapar", "haus",
  "kenyang", "sibuk", "kosong", "penuh", "aman", "bahaya", "tenang", "khawatir", "yakin",
  "ragu", "jujur", "bohong", "adil", "curang", "rajin", "malas", "hemat", "boros",
  "cerdas", "bodoh", "baik", "jahat", "sopan", "kasar", "ramah", "dingin", "hangat",
  "indah", "jelek", "cantik", "tampan", "manis", "pahit", "asam", "pedas", "gurih",
  "suara", "gambar", "warna", "angka", "huruf", "kata", "kalimat", "cerita", "lagu",
  "film", "musik", "game", "internet", "komputer", "laptop", "ponsel", "layar", "keyboard",
  "mouse", "program", "data", "server", "jaringan", "aplikasi", "website", "akun",
  "password", "login", "logout", "upload", "download", "kirim", "terima", "chat",
  "pesan", "email", "notifikasi", "update", "versi", "fitur", "sistem", "teknologi",
  "energi", "listrik", "baterai", "mesin", "alat", "bahan", "proses", "hasil",
  "tujuan", "rencana", "ide", "solusi", "masalah", "jawaban", "pertanyaan",
  "keputusan", "kesempatan", "tantangan", "perjalanan", "pengalaman",
  "kehidupan", "impian", "kenangan", "harapan", "usaha", "kerjasama",
  "keberhasilan", "kegagalan", "perubahan", "perkembangan", "kemajuan",
  "kebahagiaan", "kesedihan", "keberanian", "ketakutan", "kesehatan",
  "pendidikan", "pekerjaan", "keluarga", "persahabatan", "masyarakat",
  "budaya", "bahasa", "sejarah", "ilmu", "pengetahuan", "keterampilan",
  "latihan", "ujian", "nilai", "prestasi", "motivasi", "inspirasi"
];

        let currentText = "";
        let timeLeft = 60;
        let isPlaying = false;
        let timerInterval;
        let charIndex = 0;
        let mistakes = 0;
        let highscore = localStorage.getItem('typing_mobile_highscore') || 0;

        const textDisplay = document.getElementById('text-display');
        const typingInput = document.getElementById('typing-input');
        const timerEl = document.getElementById('timer');
        const wpmEl = document.getElementById('wpm');
        const accuracyEl = document.getElementById('accuracy');
        const highscoreEl = document.getElementById('highscore');
        const resultModal = document.getElementById('result-modal');
        const startOverlay = document.getElementById('start-overlay');
        const keys = document.querySelectorAll('.key');

        highscoreEl.innerText = highscore;

        // Deteksi jika perangkat adalah mobile/touch
        const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        if (!isTouchDevice) {
            document.getElementById('instruction-text').innerText = "Gunakan keyboard fisik untuk mengetik.";
        } else {
            document.getElementById('instruction-text').innerText = "Gunakan keyboard di layar untuk mengetik.";
        }

        function generateText() {
            const shuffled = [...kataIndonesia].sort(() => 0.5 - Math.random());
            currentText = shuffled.slice(0, 30).join(" ") + " ";
            textDisplay.innerHTML = "";
            currentText.split("").forEach(char => {
                const span = document.createElement('span');
                span.classList.add('char');
                span.innerText = char;
                textDisplay.appendChild(span);
            });
            updateCursor();
        }

        function updateCursor() {
            const spans = textDisplay.querySelectorAll('span');
            spans.forEach(s => s.classList.remove('current'));
            if (spans[charIndex]) {
                spans[charIndex].classList.add('current');
                spans[charIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function startGame() {
            if (isPlaying) return;
            isPlaying = true;
            charIndex = 0;
            mistakes = 0;
            timeLeft = 60;
            generateText();
            startOverlay.classList.add('hidden');
            
            if (!isTouchDevice) {
                typingInput.focus();
            }

            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            if (timeLeft > 0) {
                timeLeft--;
                timerEl.innerText = timeLeft + "s";
                calculateStats();
            } else {
                endGame();
            }
        }

        function calculateStats() {
            const timeElapsed = 60 - timeLeft;
            if (timeElapsed <= 0) return { wpm: 0, accuracy: 0 };
            const correctChars = charIndex - mistakes;
            const wpm = Math.max(0, Math.round((correctChars / 5) / (timeElapsed / 60)));
            const accuracy = charIndex > 0 ? Math.round(((charIndex - mistakes) / charIndex) * 100) : 0;
            wpmEl.innerText = wpm;
            accuracyEl.innerText = accuracy + "%";
            return { wpm, accuracy };
        }

        function handleInput(key) {
            if (!isPlaying) return;

            const chars = textDisplay.querySelectorAll('span');
            
            if (key === 'backspace') {
                if (charIndex > 0) {
                    charIndex--;
                    chars[charIndex].classList.remove('correct', 'incorrect');
                    updateCursor();
                }
                return;
            }

            if (charIndex < currentText.length) {
                if (key === currentText[charIndex]) {
                    chars[charIndex].classList.add('correct');
                } else {
                    chars[charIndex].classList.add('incorrect');
                    mistakes++;
                }
                charIndex++;
                
                if (charIndex === currentText.length) {
                    generateText();
                    charIndex = 0;
                    if (!isTouchDevice) typingInput.value = "";
                }
                updateCursor();
            }
        }

        function endGame() {
            clearInterval(timerInterval);
            isPlaying = false;
            const stats = calculateStats();
            
            document.getElementById('final-wpm').innerText = stats.wpm;
            document.getElementById('final-accuracy').innerText = stats.accuracy;

            if (stats.wpm > highscore) {
                highscore = stats.wpm;
                localStorage.setItem('typing_mobile_highscore', highscore);
                highscoreEl.innerText = highscore;
                document.getElementById('new-record-tag').classList.remove('hidden');
            } else {
                document.getElementById('new-record-tag').classList.add('hidden');
            }

            resultModal.classList.remove('hidden');
            resultModal.classList.add('flex');
        }

        function resetGame() {
            resultModal.classList.add('hidden');
            resultModal.classList.remove('flex');
            startOverlay.classList.remove('hidden');
            wpmEl.innerText = "0";
            accuracyEl.innerText = "0%";
            timerEl.innerText = "60s";
            textDisplay.innerHTML = "Klik tombol mulai untuk menguji kecepatan jari Anda.";
        }

        // Virtual Keyboard Listeners (Pointer events)
        keys.forEach(keyBtn => {
            keyBtn.addEventListener('pointerdown', (e) => {
                e.preventDefault();
                const keyVal = keyBtn.getAttribute('data-key');
                handleInput(keyVal);
            });
        });

        // Physical Keyboard Support
        document.addEventListener('keydown', (e) => {
            if (!isPlaying && e.key === 'Enter') {
                if (startOverlay.classList.contains('hidden')) {
                    resetGame();
                } else {
                    startGame();
                }
                return;
            }

            let key = e.key.toLowerCase();
            
            // Handle space, backspace, and a-z
            if (key === 'backspace' || key === ' ' || (key.length === 1 && key >= 'a' && key <= 'z')) {
                if (key === ' ') e.preventDefault(); // Prevent page scroll
                handleInput(key);
                
                // Highlight virtual key if visible
                const vKey = document.querySelector(`.key[data-key="${key}"]`);
                if (vKey) {
                    vKey.classList.add('key-active');
                    setTimeout(() => vKey.classList.remove('key-active'), 100);
                }
            }
        });

        // Keep focus on hidden input for desktop
        document.addEventListener('click', () => {
            if (isPlaying && !isTouchDevice) {
                typingInput.focus();
            }
        });
    </script>
</body>
</html>
